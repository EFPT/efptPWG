---
title: "Psychotherapy Study"
author: "Roberts Klotins and Thomas Gargot"
date: "March, 11th 2016"
output: 
  pdf_document: 
    toc: yes
---

# EFPT
![http://efpt.eu/wp-content/uploads/2015/11/cropped-banner_efpt.jpg](http://efpt.eu/wp-content/uploads/2015/11/cropped-banner_efpt.jpg)
The European Federation of psychiatric trainees (EFPT) is an independent federation of psychiatric trainees associations. It represents the consensus of psychiatric trainees organizations across European countries and advocates for what training should look like, regardless of the country. 

[EFPT website](http://efpt.eu/) 

# Presentation
The psychotherapy study run from 2013 to 2015 to understand the actual opportunities and wishes for training in psychotherapy in Europe among psychiatrist trainees in 19 countries.

## Presentations of the survey
### Past
* "The EFPT Psychotherapy working Group and its Survey on Psychotherapy Training 2013-2015" was presented at the [Royal College of Psychiatrists](http://www.rcpsych.ac.uk/pdf/CALC_MedPsych2015confbooklet.pdf) - faculty of Psychotherapy Annual Meeting 22-24 April 2015 by Alina Petricean (UK, Romania)
* "The EFPT Psychotherapy working group" was presented at the "Portuguese Psychiatric National Congress in 2013 by Rita Silva (Portugal)

### Projects
* Accepted talk : "Should all psychiatrists be skilled to practice psychotherapy ? Thomas GARGOT (France) and Ekin Sonmez (Turkey), [European Psychiatric Association Congress](http://efpt.eu/events/european-psychiatric-association-congress/), March 12th - March 15th 2016 
* Submission Project : "How psychiatrist trainees are trained in Psychotherapies in Europe ? A European trainee survey", Thomas GARGOT (France), [European Association of Behavioural and Cognitive Therapies conference (EABCT)](http://eabct2016.org/), August 31st - September 3rd 2016, deadline 17th march
* Submission Project : How psychiatrist trainees are trained in Psychotherapies in Europe ? A European trainee survey" in Italian, Diego Quattrone (Italy)  [Italian Federation of Psychotherapy Associations (FIAP)](http://www.fiap.info/convegno2016/)

# To do list
It can be found [here](https://github.com/r0bis/efptPWG/blob/master/about-data/todolist.md).

# Actual recommandations
## EFPT Psychotherapy Working Group statement
"A working knowledge of psychotherapy is an integral part of being a psychiatrist and this must be reflected in training in psychiatry. All trainees must gain the knowledge, skills and attitudes to be competent in psychotherapy. Competence should be gained in at least one recognised form of psychotherapy (of the trainees choice) and basic knowledge should be gained in the other forms of psychotherapy to allow the trainee to evaluate suitability for referral to specialist psychotherapist.
Training in psychotherapy must include supervision by qualified therapists. A personal psychotherapeutic experience is seen as a valuable component of training. It is crucial that trainees have access to relevant psychotherapy experience to cater to the needs of the appropriate patient group that the trainee is dealing with or is expected to deal with in the future.

Relevant training authorities should ensure that time, resources and funding are available to all trainees to meet the above mentioned psychotherapy training needs."

Discussed and voted by EFPT delegates in Lisbon 1996, Tampere 1999, Napoli 2001, Sinaia 2002, Paris 2003, Istanbul 2005, Gothenburg 2008, Cambridge 2009 and Zurich 2013

[See all EFPT statements](http://efpt.eu/statements/).

## UEMS Psychotherapy Reports
See all UEMS reports related to [psychiatry training](http://uemspsychiatry.org/board/training-reports/).

# Get the data
You can download our data and our analysis script on [GitHub](https://github.com/r0bis/efptPWG).
```{r, include = FALSE}
#install.packages(c("lattice", "ggplot2", "likert", "rmarkdown", "maps", "mapdata"))
library (lattice)
library(ggplot2)
library(knitr)
library(likert)
library(plyr)
library(rmarkdown)
library(stringr)
library(maps)
library(sm)
library(Hmisc)
library(choroplethr)
library(choroplethrMaps)
search()
```

```{r, echo=FALSE, include=FALSE}
#Set working directory
setwd("~/src/efptPWG/bin")
getwd()

## Import the data and change the variables names
readEFPTfiles <- function(f) {
  if (as.character(f)!="") {
    oldwd <- getwd()
    z <- file.path("..","data",f)
    setwd(z)
    source(paste(f,"_R_syntax_file.R",sep = ""),local = T)
    toGlEnvFrame <- data[str_detect(colnames(data),"^id$|^q_.*")]
    parentFrame <- paste(f,"_data",sep = "")
    assign(parentFrame,toGlEnvFrame,envir=.GlobalEnv)
    setwd(oldwd)
    }
  else {print("")}
}

dat.files  <- list.files(path="..", recursive=F, pattern=".*syntax_file.R$",full.names=F)
dat.dirs  <- list.dirs(path="../data/", recursive=T,full.names=F)

sapply(dat.dirs, readEFPTfiles)

correctColumns <- colnames(Bulgaria_data)
incorrectColumns <- colnames(Czech_Republic_data)
setdiff(correctColumns,incorrectColumns)

Czech_Republic_data["q_0000"] <- as.factor("Czech Republic")
Czech_Republic_data["q_0012_other"] <- as.numeric(NA)
Czech_Republic_data <- Czech_Republic_data[colnames(Bulgaria_data)]

Slovenia_data["q_0000"] <- as.factor("Slovenia")
Slovenia_data["q_0012_other"] <- as.numeric(NA)
Slovenia_data <- Slovenia_data[colnames(Bulgaria_data)]

France_data$q_0000 <- ifelse((is.na(France_data$q_0000)==FALSE), c("France"), c(NA)) 

### List of countries studied
list <- list.files("data", full.names=FALSE)
print(list)

### Binding datasets
listof.df <- lapply(ls(), function(x) if (class(get(x)) == "data.frame") get(x))
data_Europe <- do.call("rbind", listof.df)
```

# European results
```{r,include = FALSE}
dim(data_Europe)
str(data_Europe)
summary(data_Europe)
```

## Number of participants
```{r, echo = FALSE}
# table(data_Europe[which(complete.cases(data_Europe$q_0000)==TRUE),]$q_0000)
countryanswers <- sort(table(data_Europe$q_0000), decreasing = FALSE)

answering_countries <- countryanswers[which (countryanswers > 0)]
par(mar=c(4,6,2,3))
barplot(answering_countries, cex.names=0.5, las=1, main="Number of answers by country", col="cornflowerblue", horiz=TRUE, border=NA)
text(50,6, paste("Total of answers :", sum(answering_countries),
                 "
            Mean answers by country: " , round(mean(answering_countries)),"
    Top 4: Romania, France, 
    Slovenia, Czech Republic"))
abline(v=mean(answering_countries), lty=2)
## Make a map : https://github.com/ramnathv/rMaps/blob/master/README.md
```

```{r, echo=FALSE, warning=FALSE}
names <- names(countryanswers)
namesLower <- upFirst(names, alllower=TRUE)

#Replace the upper cases by lower cases
DF <- data.frame(namesLower, countryanswers, stringsAsFactors=FALSE)
names(DF) <- c("region", "value")

# change serbia by republic of serbia
DF[which(DF$region=="serbia"),1] <- "republic of serbia"

# deleting malta which is not in your regions
DF <-DF[-which(DF$region=="malta" | DF$region=="andorra" | DF$region=="liechtenstein" | DF$region=="monaco" | DF$region=="san marino"),]

## Problem with France data
DF <- DF[-26,]
## Discussion here

country_choropleth(DF,
                 legend = "Number",
                 zoom = c("albania", "armenia", "austria", "azerbaijan", "belgium", "bosnia and herzegovina", "belarus", "bulgaria", "croatia",   "cyprus"  , "czech republic", "denmark", "greece", "estonia", "finland", "france",  "georgia", "germany", "hungary", "iceland", "kazakhstan", "luxembourg", "netherlands", "norway", "ireland", "israel", "italy", "ireland", "latvia", "lithuania", "macedonia", "moldova", "montenegro", "poland", "portugal", "romania", "russia", "slovakia", "slovenia", "spain", "sweden", "switzerland", "united kingdom", "republic of serbia", "turkey", "ukraine")) + xlim(-20,30) + ylim(30,75) + ggtitle("Participants of the study") + theme(plot.title = element_text(lineheight=15, face="bold"))
```

## Gender
```{r, echo=FALSE, fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
gender <-table(data_Europe$q_0001)
pie(gender, main="Gender of participants in Europe reponses")
```

##Age
```{r, echo=FALSE,  fig.height=4}
par(mfrow=c(1,1), mar=c(3,3,2,2))
#error max = 1969 !!!
age_Europe <- data_Europe$q_0002[which(data_Europe$q_0002<1969)]
hist(age_Europe, col="cornflowerblue",
     xlab="Age", ylab="Number", main="Age distribution", freq=TRUE, border=NA)
text(47, 220, paste("Mean age:", round(mean(age_Europe),0), "years"))
abline(v=mean(age_Europe), lty=2)
```

## Year in Training
```{r, echo=FALSE}
YoT <- table(data_Europe$q_0003)
names(YoT)<- c(1:8, "> 8", "Training finished")
par(mfrow=c(1,1), mar=c(3,3,2,2))
barplot(YoT, main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number", cex.names=0.5)
```

## Are you receiving personal psychotherapy or have you received it in the past?
```{r, echo=FALSE}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
data_Europe[, 7] <- as.numeric(data_Europe[, 7])
attributes(data_Europe)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
data_Europe[, 7] <- factor(data_Europe[, 7], levels=c(1,2),labels=c("Yes","No"))
names(data_Europe)[7] <- "q_0004"
#table(data_Europe$q_0004)
par(mar=c(3,3,2,2))
pie(table(data_Europe$q_0004), main = "Receiving personal psychotherapy (present or past)")
```

```{r, echo=FALSE}
## I am undertaking training in Psychotherapy within my training programme in Psychiatry
## NO DATA ????
#tab <- table(data_Europe$q_0005_S05A1)
#length(tab)
#pie(table(data_Europe$q_0005_S05A1), main="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r, echo=FALSE}
#table(data_Europe$q_0005_S05A2)
pie(table(data_Europe$q_0005_S05A2), main="Training in psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r, echo=FALSE}
#table(data_Europe$q_0005_S05A3)
pie(table(data_Europe$q_0005_S05A3),  main="I am not undertaking any training in Psychotherapy")
```

> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r, echo=FALSE}
#table(data_Europe$q_0005_S05A4)
pie(table(data_Europe$q_0005_S05A4), main="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r, echo=FALSE}
#table(is.na(data_Europe$q_0006))
pie(table(is.na(data_Europe$q_0006)),main="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r, echo=FALSE}
#table(data_Europe$q_0007)
pie(table(data_Europe$q_0007), main="Psychotherapy important for the professional identity")
```

## Do you want to practise Psychotherapy ?
```{r, echo=FALSE}
#table(data_Europe$q_0008)
pie(table(data_Europe$q_0008), main="Plan to practise Psychotherapy after training")
```

## Are you interested in this psychotherapy?
```{r, echo=FALSE}
q9df <- data_Europe[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","Not Any","Other"),main="Interested in this therapy", las=1, col=rainbow(6))
```

##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"
```{r, echo=FALSE, eval=FALSE}

barplot(table(data_Europe$q_0011_SQ001), col="green", main="Theoretical lectures or seminars in Psychotherapy", border=NA)
abline(v=1.3, lwd=3)
text(0.6,215, "UEMS <", adj = c(0, -.1), font=2)
```
> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r, echo=FALSE, eval=FALSE}
#barplot(PWS, col="blue", main="Conducting Psychotherapy without supervision", border=NA)
```

```{r, echo=FALSE, eval=FALSE}

barplot(table(data_Europe$q_0011_SQ003), col="yellow", main="Conducting Psychotherapy under supervision")
```

```{r, echo=FALSE, eval=FALSE}
barplot(table(data_Europe$q_0011_SQ004), col="orange", main="Personal Psychotherapy")
```

```{r, echo=FALSE}
TL <- table(data_Europe$q_0011_SQ001)
PNS <- table(data_Europe$q_0011_SQ002)
PWS <- table(data_Europe$q_0011_SQ003)
PP <- table(data_Europe$q_0011_SQ004)

mandatory <- cbind(prop.table(TL),prop.table(PNS), prop.table(PWS), prop.table(PP))
par(mar=c(2.5,3,5,5), xpd=TRUE)
barplot(mandatory, col=terrain.colors(3), names=c("Theorical lectures", "Psychotherapy 
no supervision", "Psychotherapy 
with supervision", "Personnal 
psychotherapy"), cex.name=0.8, main="The following experience in Psychotherapy is a mandatory 
part of my training in Psychiatry")
legend("topright", inset=c(-0.19,0), legend = c("Yes", "No", "Uncertain"), fill=(terrain.colors(3)), cex=0.8)
```

```{r, echo=FALSE}
#table(data_Europe$q_0012)
barplot(table(data_Europe$q_0012), col=terrain.colors(3) , main="Are you qualified to practice Psychotherapy after your training ?")
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
```{r, echo=FALSE}
#table(data_Europe$q_0013)
```

## How many hours of supervision
```{r, echo=FALSE}
par(mar=c(4,4,3,3), xpd=FALSE)
plot(density(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]), col=rainbow(5)[1], xlim=c(0,10), main ="Repartition of the hours of supervision in Europe", ylab="Frenquency", xlab= "Hours")

text(3.5, 0.30, paste("Mean :", round(mean(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]),2), "h"), col=rainbow(5)[1], font=2)
abline(v=mean(data_Europe$q_0014_SQ001[which(is.na(data_Europe$q_0014_SQ001)==FALSE)]), col=rainbow(5)[1], lwd=2)

abline(v=1.7, lty=2, lwd=2)
text(3.5,0.36, "UEMS > 1.7h", font=2)

lines(density(data_Europe$q_0014_SQ002[which(is.na(data_Europe$q_0014_SQ002)==FALSE)]), col=rainbow(5)[2])
lines(density(data_Europe$q_0014_SQ003[which(is.na(data_Europe$q_0014_SQ003)==FALSE)]), col=rainbow(5)[3])
lines(density(data_Europe$q_0014_SQ004[which(is.na(data_Europe$q_0014_SQ004)==FALSE)]), col=rainbow(5)[4])
lines(density(data_Europe$q_0014_SQ005[which(is.na(data_Europe$q_0014_SQ005)==FALSE)]), col=rainbow(5)[5])

legend("topright", legend=c("Hours of Psychotherapy supervision per month", "Small group supervision (3 - 5 people)", "Large group supervision (more than 5 people)", "Generic Balint group", "Other form of supervision"), fill = rainbow(4), cex=0.7)
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r, echo=FALSE, eval=FALSE}
hist(data_Europe$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(2.5,300, "> UEMS", font=2)
```

```{r, echo=FALSE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(data_Europe$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r, echo=FALSE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(data_Europe$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r, echo=FALSE, eval=FALSE}
par(mar=c(4.5,3,2,2))
hist(data_Europe$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r, echo=FALSE, eval=FALSE}
hist(data_Europe$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(data_Europe$q_0015)

##Who pays?
```{r, echo=FALSE, eval=FALSE}
barplot(table(data_Europe$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        names=c("I pay", "State pays", "I don't have", "Free"),
        main="Supervision - individual")
```

```{r, echo=FALSE, eval=FALSE}
barplot(table(data_Europe$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=FALSE, eval=FALSE}
barplot(table(data_Europe$q_0016_SQ004), col="light blue",
        main="Balint groups",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=FALSE, eval=FALSE}
barplot(table(data_Europe$q_0016_SQ005), col="light blue",
        main="Sessions with patient(s)",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays ?")
```

```{r, echo=FALSE, eval=FALSE}
barplot(table(data_Europe$q_0016_SQ006), col="light blue",
        main="Self-experience",
        names=c("I pay", "State", "I don't have", "Free"),
        xlab="Who pays")
```

```{r, echo=FALSE}
par(mar=c(3.5,2.5,3,5), xpd=TRUE)
payTL <- table(data_Europe$q_0016_SQ001)
paySI <- table(data_Europe$q_0016_SQ002)
paySG <- table(data_Europe$q_0016_SQ003)
payBG <- table(data_Europe$q_0016_SQ004)
paySP <- table(data_Europe$q_0016_SQ005)
paySE <- table(data_Europe$q_0016_SQ006)
pay <- cbind(prop.table(payTL), prop.table(paySI), prop.table(paySG), prop.table(payBG), prop.table(paySP), prop.table(paySE))
barplot(pay, col=terrain.colors(4),
        main="Who pays?",
        names=c("Theorectical 
lectures", "Supervision 
indiv.", "Supervision 
group", "Balint
groups ", "Sessions
with patient(s)", "Self
experience"), cex.name=0.7)
legend("topright", inset=c(-0.18,0), legend = c("I pay", "The state pays", "I don't have", "Free"), fill=(terrain.colors(4)), cex=0.6)
```

## Would you train for free?
```{r, echo=FALSE}
par(mar=c(3,2,2,2))
pie(table(data_Europe$q_0017),
    main="Motivated to train in Psychotherapy for free?")
text(-0.2,-0.95, "UEMS recommendations states that psychotherapy training 
of trainees should be funded publicly and free for trainees.")
```

## How much would you invest in psychotherapy training ?
```{r, echo=FALSE}
hist(data_Europe$q_0018[which(data_Europe$q_0018<100)], col="light green",
     main="% of annual salary for psychiatry training",
     xlab="Percentage of your annual salary do you intend to spend \n on funding your psychotherapy training In the next 12 months?")
abline(v=mean(data_Europe$q_0018[which(data_Europe$q_0018<100)]), lwd=2)
text(15, 200, paste("Mean :",round( mean(data_Europe$q_0018[which(data_Europe$q_0018<100)])), " %"), font=2)
```

## Satisfaction group
```{r, echo=FALSE}
# make auxiliary table to hold our likert data_Europe
sat1<-data_Europe[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(data_Europe$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- data_Europe[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## UEMS recommendations awareness
```{r, echo=FALSE}
# and same with the
uems2 <- data_Europe[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```


# Czech_Republic
## Display them
```{r, include =TRUE} 
str(Czech_Republic_data)
```

## Gender
```{r}
table(Czech_Republic_data$q_0001)
```

```{r}
pie(table(Czech_Republic_data$q_0001), main ="Gender of participants")
```

## Age
```{r}
summary(Czech_Republic_data$q_0002)

hist(Czech_Republic_data$q_0002, col="orange",
     xlab="Age",
     ylab="Number",
     main="Age distribution",
     border=NA,
     breaks=c(seq(20,60,2)))
```

## Year of Training (now the shorter labels fit in the plot)
```{r}
table(Czech_Republic_data$q_0003)
barplot(table(Czech_Republic_data$q_0003), ylim = c(0,15), main="Year of training", xlab="Year", las=1, col="cornflowerblue", border=NA, ylab="Number")
```

## Are you receiving personal psychotherapy or have you received it in the past?

```{r}
# TODO : GGPLOT this : http://docs.ggplot2.org/current/geom_bar.html
Czech_Republic_data[, 7] <- as.numeric(Czech_Republic_data[, 7])
attributes(Czech_Republic_data)$variable.labels[7] <- "Are you receiving personal psychotherapy or have you received it in the past?"
Czech_Republic_data[, 7] <- factor(Czech_Republic_data[, 7], levels=c(1,2),labels=c("Yes","No"))
names(Czech_Republic_data)[7] <- "q_0004"
table(Czech_Republic_data$q_0004)
pie(table(Czech_Republic_data$q_0004), xlab="Receiving personal psychotherapy (present or past)")
```

## I am undertaking training in Psychotherapy within my training programme in Psychiatry
```{r}
#tab <- table(Czech_Republic_data$q_0005_S05A1)
#pie(tab)
#pie(table(Czech_Republic_data$q_0005_S05A1))
 #   , xlab="In a Psychotherapy training within my training programme")
```

## I am undertaking training in Psychotherapy on my own initiative
```{r}
table(Czech_Republic_data$q_0005_S05A2)
pie(table(Czech_Republic_data$q_0005_S05A2), 
  xlab="Training in Psychotherapy outside my training programme")
```

## I am not undertaking any training in Psychotherapy
```{r}
table(Czech_Republic_data$q_0005_S05A3)
pie(table(Czech_Republic_data$q_0005_S05A3), 
  xlab="I am not undertaking any training in Psychotherapy")
```
> Psychotherapy training taking place within working hours is recommended by UEMS as a mandatory component of curriculum.

## I have completed full training in a Psychotherapy specialty in the past
```{r}
table(Czech_Republic_data$q_0005_S05A4)
pie(table(Czech_Republic_data$q_0005_S05A4), xlab="Completed a full training in a Psychotherapy (past)")
```

## I am training in some modality
```{r}
table(is.na(Czech_Republic_data$q_0006))
pie(table(is.na(Czech_Republic_data$q_0006)),xlab="I am training in some modality of psychotherapy")
```

## Is psychotherapy important for your identity as a psychiatrist ?
```{r}
table(Czech_Republic_data$q_0007)
pie(table(Czech_Republic_data$q_0007), xlab="Psychotherapy important for the professional identity")
```

## Do you want to practise Psychotherapy ?
```{r}
table(Czech_Republic_data$q_0008)
pie(table(Czech_Republic_data$q_0008), xlab="Plan to practise Psychotherapy after training")
```

```{r}
q9df <- Czech_Republic_data[,16:21]
barplot(c(sum(q9df[,1]=="Yes"), sum(q9df[,2]=="Yes"), sum(q9df[,3]=="Yes"), sum(q9df[,4]=="Yes"),
         sum(q9df[,5]=="Yes"), sum(!is.na(q9df[,6]))),
        names.arg=c("Dynamic","CBT","Systemic","Group","NOT ANY","Other"),xlab="Interested in this therapy")
```


##"The following experience in Psychotherapy is a mandatory part of my training in Psychiatry:"

```{r}
table(Czech_Republic_data$q_0011_SQ001)
barplot(table(Czech_Republic_data$q_0011_SQ001), col="green", xlab="Theoretical lectures or seminars in Psychotherapy")
abline(v=1.3, lwd=3)
text(0.6,5, "UEMS <", adj = c(0, -.1))
```

> UEMS Charter on Psychiatry states that minimum duration of theoretical psychotherapy training should be 120 hours during 5 years. It also states that as a minimum, psychodynamic, CBT and systemic theory should be taught.

```{r}
table(Czech_Republic_data$q_0011_SQ001)
barplot(table(Czech_Republic_data$q_0011_SQ001), col="blue", xlab="Conducting Psychotherapy without supervision")
```

```{r}
table(Czech_Republic_data$q_0011_SQ003)
barplot(table(Czech_Republic_data$q_0011_SQ003), col="yellow", xlab="Conducting Psychotherapy under supervision")
```

```{r}
table(Czech_Republic_data$q_0011_SQ004)
barplot(table(Czech_Republic_data$q_0011_SQ004), col="orange", xlab="Personal Psychotherapy")
```

```{r}
table(Czech_Republic_data$q_0012)
barplot(table(Czech_Republic_data$q_0012), col="green", xlab="Are you qualified to practice Psychotherapy after your training ?")
```

## What types of psychotherapy modalities are available for treatment of patients at your institution?
> table(Czech_Republic_data$q_0013)

## How many hours of supervisions
```{r, echo=FALSE}
hist(Czech_Republic_data$q_0014_SQ001, col="pink",
     xlab="Hours of Psychotherapy supervision per month",
     main = "Individual supervision",
     breaks=6)
abline(v=1.7, lwd=3)
text(1.75,5, "> UEMS", adj = c(0, -.1))
```

> UEMS Charter on Psychiatry states that minimum duration of psychotherapy supervision should be 100 hours during the whole training of 5 recommended years. It makes 1.7 hours approximatively a month.

```{r}
hist(Czech_Republic_data$q_0014_SQ002, col="red",
     main="Small group supervision (3 - 5 people)",
     xlab="Hours of Psychotherapy supervision per month")
```

```{r}
hist(Czech_Republic_data$q_0014_SQ003,
     main="Large group supervision (more than 5 people)",
     xlab="Hours of Psychotherapy supervision per month",
     col= "orange")
```

```{r}
hist(Czech_Republic_data$q_0014_SQ004, col="green",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Generic Balint group",
     breaks=10)
```

```{r}
hist(Czech_Republic_data$q_0014_SQ005, col="navy",
     xlab= "Hours of Psychotherapy supervision per month",
     main ="Other form of supervision")
```

table(Czech_Republic_data$q_0015)

## Who pays?
This again should ba a plot group on one page
```{r}
barplot(table(Czech_Republic_data$q_0016_SQ001), col="light blue",
        main="Theorectical lectures / seminars",
        xlab="Who pays for this component of Psychotherapy experience?")
```

```{r}
barplot(table(Czech_Republic_data$q_0016_SQ002), col="light blue",
        xlab="Who pays for this component of Psychotherapy experience?",
        main="Supervision - individual")
```

```{r}
barplot(table(Czech_Republic_data$q_0016_SQ003), col="light blue",
        main="Supervision - group",
        xlab="Who pays ?")
```

```{r}
barplot(table(Czech_Republic_data$q_0016_SQ004), col="light blue",
        main="Balint groups ",
        xlab="Who pays ?")
```

```{r}
barplot(table(Czech_Republic_data$q_0016_SQ004), col="light blue",
        main="Sessions with patient(s)",
        xlab="Who pays ?")
```

```{r}
barplot(table(Czech_Republic_data$q_0016_SQ004), col="light blue",
        main="Self-experience",
        xlab="Who pays")
```

## Plot: Would you train for Free ?
```{r}
pie(table(Czech_Republic_data$q_0017),
    xlab="Motivated to train in Psychotherapy for free?")
```

UEMS recommendations states that psychotherapy training of trainees should be funded publicly and free for trainees.

## Plot: How much would you invest in psychotherapy training ?
```{r}
hist(Czech_Republic_data$q_0018, col="light green",
     main="% of annual salary for psychiatry training",
     xlab="Percentage of your annual salary do you intend to spend \n on funding your psychotherapy training In the next 12 months?",
     breaks=c(seq(0,100,2)))
```

## Plot: Satisfaction group
perhaps we should use likert package to plot likert type items

```{r}
# make auxiliary table to hold our likert Czech_Republic_data
sat1<-Czech_Republic_data[,43:45]
# put in correct row names
sat1 <- rename(sat1,c("q_0019_SQ001"="I am satisfied with psychotherapy component in my training programme",
  "q_0019_SQ002"="I am satisfied with psychotherapy training options in my country",
  "q_0019_SQ003"="I am satisfied with the level of funding for psychotherapy training within psychiatry in my country"
  ))
sat12<-likert(sat1)
plot(sat12)
# comment out barplots for now
# barplot(table(Czech_Republic_data$q_0019_SQ001), main ="I am satisfied with Psychotherapy component in my training programme")

# well, let's deal with UEMS bits as with likert scales
uems1 <- Czech_Republic_data[,46:54]
uems1[,1] <- factor(uems1[,1],c("No","Uncertain","Yes"))
uems1[,2] <- factor(uems1[,2],c("No","Uncertain","Yes"))
uems1[,3] <- factor(uems1[,3],c("No","Uncertain","Yes"))
uems1[,4] <- factor(uems1[,4],c("No","Uncertain","Yes"))
uems1[,5] <- factor(uems1[,5],c("No","Uncertain","Yes"))
uems1[,6] <- factor(uems1[,6],c("No","Uncertain","Yes"))
uems1[,7] <- factor(uems1[,7],c("No","Uncertain","Yes"))
uems1[,8] <- factor(uems1[,8],c("No","Uncertain","Yes"))
uems1[,9] <- factor(uems1[,9],c("No","Uncertain","Yes"))
# Put nice column names for the plot
uems1 <- rename(uems1,c(
  q_0021_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0021_SQ002="Defined number of cases should be seen",
  q_0021_SQ003="at least 120 hours of theory",
  q_0021_SQ004="Work experience with individuals, family, groups",
  q_0021_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0021_SQ006="Personal therapy is recommended",
  q_0021_SQ007="Supervisors should be qualified",
  q_0021_SQ008="Regular supervision at least for 100 hours",
  q_0021_SQ009="Training should be publicly funded"
  ))
## Plot: UEMS recs awareness
uems12 <- likert(uems1)
plot(uems12) +
  ggtitle("Awareness of UEMS recommendations") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## Plot: UEMS recommendations awareness
```{r}
# and same with the
uems2 <- Czech_Republic_data[,55:63]
uems2[,1] <- factor(uems2[,1],c("No","Uncertain","Yes"))
uems2[,2] <- factor(uems2[,2],c("No","Uncertain","Yes"))
uems2[,3] <- factor(uems2[,3],c("No","Uncertain","Yes"))
uems2[,4] <- factor(uems2[,4],c("No","Uncertain","Yes"))
uems2[,5] <- factor(uems2[,5],c("No","Uncertain","Yes"))
uems2[,6] <- factor(uems2[,6],c("No","Uncertain","Yes"))
uems2[,7] <- factor(uems2[,7],c("No","Uncertain","Yes"))
uems2[,8] <- factor(uems2[,8],c("No","Uncertain","Yes"))
uems2[,9] <- factor(uems2[,9],c("No","Uncertain","Yes"))

# Put nice column names for the plot
uems2 <- rename(uems2,c(
  q_0022_SQ001="Psychotherapy is a mandatory part of the curriculum",
  q_0022_SQ002="Defined number of cases should be seen",
  q_0022_SQ003="at least 120 hours of theory",
  q_0022_SQ004="Work experience with individuals, family, groups",
  q_0022_SQ005="Psychodynamic, CBT, systemic - and maybe integrative",
  q_0022_SQ006="Personal therapy is recommended",
  q_0022_SQ007="Supervisors should be qualified",
  q_0022_SQ008="Regular supervision at least for 100 hours",
  q_0022_SQ009="Training should be publicly funded"
))
uems22 <- likert(uems2)
plot(uems22) +
  ggtitle("Actual implementation in the country") +
  theme(plot.title = element_text(lineheight=.8, face="bold"))
```

## Research
UEMS recommendations states that research methodology should be included in psychotherapy training.

## Bibliography
* Please join our [zotero group](https://www.zotero.org/groups/480046)

